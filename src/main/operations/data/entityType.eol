@cached
operation JUDOPSM!EntityType hasCircularReference() {
	return self.hasCircularReference(self.superEntityTypes);
}

operation JUDOPSM!EntityType hasCircularReference(visited : Collection) {
    if (visited.includes(self)) {
        return true;
    } else if (visited.isEmpty()) {
        return false;
    }

    return self.hasCircularReference(self.superEntityTypes.collect(s | s.superEntityTypes).flatten());
}
